<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <link rel="icon" href="../../img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="../../../css/style-general.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sesi√≥n 26</title>
  <!-- Formatear code. Agrega la hoja de estilo para el tema oscuro (por ejemplo, Dracula)-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/dracula.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
  <script>document.addEventListener('DOMContentLoaded', (event) => { hljs.highlightAll(); })</script>
</head>

<body>
  <nav class="nav heartbeat">
    <input type="checkbox" id="toggle-menu">
    <label for="toggle-menu" class="icono-hamburguesa"><span></span></label>  
    <ul>
      <li>Sesi√≥n 10</li>
      <li><a href="../sesion10/index.html#and-or">And/Ord</a> </li>
      <li><a href="../sesion10/index.html#switch">Switch</a> </li>
      <li><a href="../sesion10/index.html#ciclo-for">For</a> </li>
      <li><a href="../sesion10/index.html#for-of-in">For of/in</a> </li>
      <li><a href="../sesion10/index.html#while">While</a> </li>
      <li>Sesi√≥n 11</li>
      <li><a href="../sesion11/index.html#while-ejer-multiplos">While Ejer</a> </li>
      <li><a href="../sesion11/index.html#functions">Functions</a> </li>
      <li><a href="../sesion11/index.html#function-anonima">Function Anon</a> </li>
      <li><a href="../sesion11/index.html#function-arrow">Function Arrow</a> </li>
      <li><a href="../sesion11/index.html#arrays-ejer">Arrays</a> </li>
      <li><a href="../sesion11/index.html#for">For</a> </li>
      <li><a href="../sesion11/index.html#foreach">Foreach</a> </li>
      <li><a href="../sesion11/index.html#filter">Filter</a> </li>
      <li>Sesi√≥n 12</li>
      <li><a href="../sesion12/index.html#filter-ejer">Filter Ejer</a> </li>
      <li><a href="../sesion12/index.html#promise">Promise</a> </li>
      <li><a href="../sesion12/index.html#async-await">Async/Await</a> </li>
      <li>Sesi√≥n 13</li>
      <li><a href="../sesion13/index.html#promise-ejer">Promise Ejercicio</a> </li>
      <li><a href="../sesion13/index.html#import-export">Import / Export</a> </li>
      <li><a href="../sesion13/index.html#mod1-ppo">POO</a> </li>
      <li>Sesi√≥n 14</li>
      <li><a href="../sesion14/index.html#prototipos">Prototipos</a> </li>
      <li>Sesi√≥n 15</li>
      <li><a href="../sesion14/index.html#herencia">Herencia</a> </li>
      <li><a href="../sesion15/index.html#herencia-ejer">Herencia Ejercicios</a> </li>
      <li><a href="../sesion15/index.html#poliformismo">Poliformismo</a> </li>
      <li>Sesi√≥n 16</li>
      <li><a href="../sesion16/index.html#arrays-metodos">Array M√©todos</a> </li>
      <li><a href="../sesion16/index.html#arrays-fill">Array / fill() </a></li>
      <li><a href="../sesion16/index.html#arrays-foreach">Array / forEach()</a> </li>
      <li><a href="../sesion16/index.html#arrays-filter">Array / filter()</a> </li>
      <li><a href="../sesion16/index.html#arrays-find">Array / find()</a> </li>
      <li><a href="../sesion16/index.html#arrays-map">Array / map()</a> </li>
      <li><a href="../sesion16/index.html#arrays-sort">Array / sort()</a> </li>
      <li><a href="../sesion16/index.html#arrays-tosorted">Array / toSorted()</a> </li>
      <li><a href="../sesion16/index.html#tarea-comparador">Tarea comparador</a> </li>
      <li>Sesi√≥n 17</li>
      <li><a href="../sesion17/index.html#arrays-some">Array / some()</a> </li>
      <li><a href="../sesion17/index.html#arrays-filter-include">Array / filter() + include()</a> </li>
      <li><a href="../sesion17/index.html#arrays-every">Array / every()</a> </li>
      <li><a href="../sesion17/index.html#arrays-concat">Array / concat()</a> </li>
      <li><a href="../sesion17/index.html#arrays-include">Array / include()</a> </li>
      <li><a href="../sesion17/index.html#arrays-join">Array / join()</a> </li>
      <li><a href="../sesion17/index.html#arrays-reduce">Array / reduce()</a> </li>
      <li><a href="../sesion17/index.html#arrays-index-of">Array / indexOf()</a> </li>
      <li><a href="../sesion17/index.html#arrays-find-index">Array / findIndex()</a> </li>
      <li><a href="../sesion17/index.html#arrays-shift">Array / shift()</a> </li>
      <li><a href="../sesion17/index.html#arrays-unshift">Array / unshift()</a> </li>
      <li><a href="../sesion17/index.html#arrays-reverse">Array / reverse()</a> </li>
      <li><a href="../sesion17/index.html#arrays-toReverse">Array / toReverse()</a> </li>
      <li><a href="../sesion17/index.html#arrays-splice">Array / splice()</a> </li>
      <li>Sesi√≥n 18</li>
      <li><a href="../sesion18/index.html#arrays-flat">Array / flat()</a> </li>
      <li><a href="../sesion18/index.html#arrays-isArray">Array / isArray()</a> </li>
      <li><a href="../sesion18/index.html#arrays-from">Array / from()</a> </li>
      <li><a href="../sesion18/index.html#rest-operador">Operador Rest</a> </li>
      <li><a href="../sesion18/index.html#spread-operador">Operador Espread</a> </li>
      <li>Sesi√≥n 19</li>
      <li><a href="../sesion18/index.html#pilas">Pilas</a> </li>
      <li><a href="../sesion19/index.html#pilas-ejer">Pilas Ejercicios</a> </li>
      <li><a href="../sesion19/index.html#colas">Colas</a> </li>
      <li><a href="../sesion19/index.html#listas-enlazadas">Listas enlazadas</a> </li>
      <li><a href="../sesion19/index.html#tarea-lista-enlazada">Tarea listas enlazadas</a> </li>
      <li>Sesi√≥n 20</li>
      <li><a href="../sesion20/index.html#lista-enlazada-ejer">Lista enlazada ejercicios</a></li>
      <li><a href="../sesion20/index.html#arbol-binario">√Årbol binario</a></li>
      <li>Sesi√≥n 21</li>
      <li><a href="../sesion21/index.html#arboles-ejercicios">√Årbol binario ejercicios</a></li>
      <li><a href="../sesion21/index.html#grafos">Grafos</a></li>
      <li><a href="../sesion21/index.html#grafos-ejer">Grafos ejercicios</a></li>
      <li><a href="../sesion21/index.html#grafos-bfs">Grafos / BFS</a></li>
      <li><a href="../sesion21/index.html#grafos-dfs">Grafos / DFS</a></li>
      <li><a href="../sesion21/index.html#algoritmo-busqueda-lineal">Algoritmos / b√∫squeda lineal</a></li>
      <li>Sesi√≥n 22</li>
      <li><a href="../sesion22/index.html#algoritmo-busqueda-lineal">Algoritmos / B√∫squeda binaria</a></li>
      <li><a href="../sesion22/index.html#algoritmo-quicksort">Algoritmos / Quicksort</a></li>
      <li><a href="../sesion22/index.html#algoritmo-mergesort">Algoritmos / MergeSort</a></li>
      <li>Sesi√≥n 23</li>
      <li><a href="../sesion23/index.html#algoritmo-bubble-sort">Algoritmos / Bubble Sort</a></li>
      <li><a href="../sesion23/index.html#algoritmo-select-sort">Algoritmos / Select Sort</a></li>
      <li><a href="../sesion23/index.html#algoritmo-insertion-sort">Algoritmos / Insertion Sort</a></li>
      <li>Sesi√≥n 24</li>
      <li><a href="../sesion24/index.html#algoritmo-radix-sort">Algoritmos / Radix Sort</a></li>
      <li><a href="../sesion24/index.html#json-web-token">Json Web Token - Parte 1</a></li>
      <li>Sesi√≥n 25</li>
      <li><a href="../sesion25/index.html#json-web-token-dos">Json Web Token - Parte 2</a></li>
      <li><a href="../sesion25/index.html#crud-express-mongodb-uno">CRUD / Express y MongoDB - Parte 1</a></li>
      <li>Sesi√≥n 26</li>
      <li><a href="../sesion26/index.html#crud-express-mongodb-dos">CRUD / Express y MongoDB - Parte 2</a></li>
      <li>Sesi√≥n 27</li>
      <li><a href="../sesion27/index.html#crud-express-mongodb-tres">CRUD / Express y MongoDB - Parte 3</a></li>
      <li>Sesi√≥n 28</li>
      <li><a href="../sesion28/index.html#crud-express-mysql-uno">CRUD / Express y MySql - Parte 1</a></li>
      <li>Sesi√≥n 29</li>
      <li><a href="../sesion29/index.html#crud-express-mysql-dos">CRUD / Express y MySql - Parte 2</a></li>
      <li>Sesi√≥n 30</li>
      <li><a href="../sesion30/index.html#react-uno">React - Parte 1</a></li>
      <li>Sesi√≥n 31</li>
      <li><a href="../sesion31/index.html#react-dos">React - Parte 2</a></li>
      <li><a href="../sesion31/index.html#react-vite">React con Vite</a></li>
      <li><a href="../sesion31/index.html#react-ejer-card-one">React - Ejercicio Cards - Parte 1</a></li>
      <li>Sesi√≥n 32</li>
      <li><a href="../sesion32/index.html#react-ejer-card-dos">React - Ejercicio Cards - Parte 2</a></li>
      <li><a href="../sesion32/index.html#react-actividad">React - Actividad</a></li>
      <li>Sesi√≥n 33</li>
      <li><a href="../sesion33/index.html#react-hook">React - Hook</a></li>
      <li><a href="../sesion33/index.html#react-hook-use-state">React - Hook {useState}</a></li>
      <li><a href="../sesion33/index.html#react-hook-use-effect">React - Hook {useEffect}</a></li>
    </ul>
  </nav>
  <h1>SESI√ìN 26</h1>
  <small class="fecha">16.04.2024 S26-M2</small>


  <article id="crud-express-mongodb-dos">
    <h2>CRUD / Express y MongoDB - Parte 2</h2>
    <p>En esta sesi√≥n se van a crear los siguientes archivos: </p>
    <pre class="dark">
      <div class="pre-head">
        <span class="tag js">js</span>
        <button class="copy-button">üìã Copiar c√≥digo</button>
      </div>
      <code class="language-js">

‚Üì config
    <b style="color: #cdb632c0">db.js</b> // New
‚Üì controllers 
    <b style="color: #cdb632c0">ClienteController.js</b> // New
‚Üì models 
    <b style="color: #cdb632c0">Cliente.js</b> // New
‚Üí node_modules
‚Üì routes 
    <b style="color: #cdb632c0">RouterCliente.js</b> // New
‚Üí src 
  .env
  package-lock.json
  package.json

      </code>
    </pre> 
    <p>El archivo <b>config/db.js</b> es el que contiene la funci√≥n para la conexi√≥n con la BD </p>
    <pre class="dark">
      <div class="pre-head">
        <span class="tag js">db.js</span>
        <button class="copy-button">üìã Copiar c√≥digo</button>
      </div>
      <code class="language-js">

const mongoose = require('mongoose');
require('dotenv').config();

// funci√≥n para conectar a la base de datos

const conectarBD = () => {
  mongoose
  .connect(process.env.MONGO_URL)
  .then(() => console.log("Conectado a la base de datos ‚ö°"))
  .catch((err) => console.error(err));
}

module.exports = conectarBD;

      </code>
    </pre> 
    <p>Los archivos <b>ClienteController.js</b>, <b>Cliente.js</b> y <b>RouterCliente.js</b> se encargan de la gesti√≥n de ingreso de datos a nuestra base de datos. Se establecen las rutas a usar, los modelos y sus respectivas funciones</p>
    
    <pre class="dark">
      <div class="pre-head">
        <span class="tag js">ClienteController.js</span>
        <button class="copy-button">üìã Copiar c√≥digo</button>
      </div>
      <code class="language-js">

// Exportamos nuestro modelo
const Cliente = require('../models/Cliente');

// Creamos una funci√≥n para agregar clientes
exports.agregarClientes = async(req, res) => {
  try {
    let clientes = new Cliente(req.body)
    await clientes.save();
    res.send(clientes);
    
  } catch (error) {
    console.log(error)
    res.status(500).send('hubo un error al agregar un cliente üòï')
  }
}

// Creamos la funci√≥n para mostrar clientes
exports.mostrarClientes = async (req, res) => {
  try {
    const clientes = await Cliente.find();
    res.json(clientes);
    
  } catch (error) {
    console.log(error)
    res.status(500).send('hubo un error al mostrar un cliente üòï')
  }
}

      </code>
    </pre> 
    <div class="nota">
      <span class="tag tag-nota">NOTA</span>
      El c√≥digo define dos funciones para gestionar clientes en una aplicaci√≥n Node.js con Express y Mongoose. La funci√≥n agregarClientes agrega un nuevo cliente a la base de datos utilizando el modelo Cliente, mientras que mostrarClientes recupera y muestra todos los clientes almacenados. Ambas funciones manejan errores mediante un bloque try/catch, registrando cualquier error en la consola y enviando respuestas de error al cliente cuando sea necesario.
    </div>

    <pre class="dark">
      <div class="pre-head">
        <span class="tag js">Cliente.js</span>
        <button class="copy-button">üìã Copiar c√≥digo</button>
      </div>
      <code class="language-js">

// Cliente.js Va a contener el modelo, el modelo debe ser igual a lo que tenga la base de datos:

const mongoose  = require ('mongoose');
const clientesSchema = mongoose.Schema({

  nombres: {type: String, required: true}, 
  apellidos: {type: String, required: true}, 
  cedula: {type: Number, required: true}, 
  correo: {type: String, required: true}, 
  telefono: {type: Number, required: true}, 
  direccion: {type: String, required: true}, 

}, {versionkey: false});

module.exports = mongoose.model('Cliente', clientesSchema)


      </code>
    </pre> 
    <div class="nota">
      <span class="tag tag-nota">NOTA</span>
      Este c√≥digo define el modelo Cliente para una base de datos MongoDB utilizando Mongoose en una aplicaci√≥n Node.js. El esquema clientesSchema especifica las propiedades y tipos de datos que deben tener los documentos de la colecci√≥n "clientes", incluyendo campos como nombres, apellidos, c√©dula, correo, tel√©fono y direcci√≥n. Finalmente, el modelo se exporta para que pueda ser utilizado en otras partes de la aplicaci√≥n.
    </div>

    <pre class="dark">
      <div class="pre-head">
        <span class="tag js">RoutersCliente.js</span>
        <button class="copy-button">üìã Copiar c√≥digo</button>
      </div>
      <code class="language-js">

const express = require('express');
const router = express.Router();
const ClienteController = require('../controllers/ClienteController');

router.post('/', ClienteController.agregarClientes);
router.get('/', ClienteController.mostrarClientes);


module.exports = router;

      </code>
    </pre> 
    <div class="nota">
      <span class="tag tag-nota">NOTA</span>
      Este c√≥digo configura un enrutador en una aplicaci√≥n Express de Node.js. Utiliza el m√≥dulo express para crear un nuevo enrutador con express.Router(). Luego, importa el ClienteController, que contiene m√©todos para manejar las solicitudes POST y GET relacionadas con clientes. El enrutador se configura para escuchar las rutas '/' con m√©todos POST y GET, que ser√°n manejadas por las funciones agregarClientes y mostrarClientes del ClienteController, respectivamente. Finalmente, exporta el enrutador para que pueda ser utilizado en otros archivos de la aplicaci√≥n.
    </div>
    
    <p>Por ultimo el archivo <b>src/index.js</b> queda con la siguiente configuraci√≥n parea que todo funciones de manera correcta</p>
    <pre class="dark">
      <div class="pre-head">
        <span class="tag js">index.js</span>
        <button class="copy-button">üìã Copiar c√≥digo</button>
      </div>
      <code class="language-js">

// Aqu√≠ iniciaremos express
const express = require('express');

//new sesi√≥n 26
const conectarBD = require('../config/db');
const cors = require ('cors');

// Configurando express y puerto
const app = express();
const port = 5000;

//new sesi√≥n 26
app.use(express.json());
// Aca van las rutas de los m√≥dulos
app.use('/api/clientes', require('../routes/RoutersCliente'));
//enlazamos la conexi√≥n de la BD
conectarBD();
app.use(cors());


// Puerto donde se lanza el servidor
app.listen(port, () => console.log('Nuestro servidor se encuentra conectado üòé http://localhost:', port));

app.get('/', (req, res) =>{
  res.send('Bienvenido, nuestro servidor esta configurado');
});

      </code>
    </pre> 




    <p>Si comprobamos el c√≥digo con <b>Postman</b>, ingresando datos a nuestra base de datos podemos comprobar que funciona tanto para <b>POST</b> como <b>GET</b></p>
    <h3>Probando las funciones, ingresar y mostrar datos</h3>
    <p>Comprobando <b>POST</b></p>
    <img src="post.png" alt="">
    <p>Comprobando <b>GET</b></p>
    <img src="get.png" alt="">
  </article>

  <footer>
    Bryan Hern√°ndez | Telento Tech DWFSV2-42 | 2024
  </footer>
  <script src="../../../js/js-general.js"></script>
  <script src="sesion26.js" type="module"></script>
</body>

</html>